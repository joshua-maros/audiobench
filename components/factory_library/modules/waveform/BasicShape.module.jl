# Chosen by fair dice roll
# Guaranteed to be random
const NOISE_TABLE = SA_F32[
    0.5823733057, 0.9205345657, 0.6571298125, 0.2043478687, 0.0512690046, 0.7195207713, 0.2310517188, 0.9231509820, 0.4526838440, 0.0260594523, 0.0544928862, 0.1159314989, 0.6362018928, 0.9405871960, 0.6264985620, 0.2124264443, 0.9875042798, 0.5048588941, 0.4584656122, 0.0476017861, 0.0288889159, 0.6630403250, 0.1075030279, 0.3067326273, 0.9282126274, 0.0489180574, 0.1897491045, 0.1516381450, 0.6479914077, 0.5966626517, 0.4706642329, 0.9586591313, 0.6251782560, 0.0076425701, 0.3360183227, 0.6176969668, 0.6220597604, 0.7335311112, 0.7775641042, 0.1995585811, 0.5877232887, 0.6093249228, 0.6400574417, 0.6418364406, 0.0491156122, 0.8943623489, 0.9641463493, 0.1186706294, 0.8703927354, 0.5001623698, 0.0056789845, 0.8819698228, 0.7906626464, 0.9055616444, 0.4516002782, 0.5868636653, 0.3968439417, 0.7977244927, 0.1008400526, 0.8151222552, 0.9223453225, 0.3447953142, 0.1643775846, 0.3701962001,
    0.8219128569, 0.1433063551, 0.1008244504, 0.2759908145, 0.3385794923, 0.3720992678, 0.5390982539, 0.4045148123, 0.3129078015, 0.0905247719, 0.3636522633, 0.1815615606, 0.5866425786, 0.3635969325, 0.7118137809, 0.9413958251, 0.8462901983, 0.7086461944, 0.2116179209, 0.9558813899, 0.7712728058, 0.7436435592, 0.1174792689, 0.4402326317, 0.3300473314, 0.7258179635, 0.6852669441, 0.8268835500, 0.9414339859, 0.9698785453, 0.2198778432, 0.4993178479, 0.9458775302, 0.4651419338, 0.9475727742, 0.7516902440, 0.5921997640, 0.5647117736, 0.3013841324, 0.6477727130, 0.3548120713, 0.6580563145, 0.4555038559, 0.1969513888, 0.3823855544, 0.4797867289, 0.6586882920, 0.8334892165, 0.6235895636, 0.9407863655, 0.0075790714, 0.6499866010, 0.6128024268, 0.3511917680, 0.7220454357, 0.0042356840, 0.4927558066, 0.3164420912, 0.8955885591, 0.3571066220, 0.4981550359, 0.0989912997, 0.3712778393, 0.3266162353,
    0.7478513378, 0.6276269444, 0.8296789683, 0.4610411459, 0.0314418181, 0.4869558270, 0.7031032450, 0.2127670626, 0.0680087881, 0.8889250267, 0.8341707040, 0.1246116881, 0.0000052800, 0.7495491208, 0.0503713413, 0.4544045378, 0.8691414718, 0.9367935365, 0.5428859015, 0.2169552000, 0.6843056289, 0.9442384416, 0.1008210213, 0.4999945500, 0.9061539286, 0.5784019420, 0.6173300311, 0.5558337790, 0.2850517636, 0.1011729350, 0.1542427349, 0.0508586863, 0.3768541338, 0.0972577220, 0.7144678479, 0.5576695303, 0.8094812596, 0.2209368912, 0.5436705058, 0.3966998104, 0.5256404117, 0.5910491356, 0.7311703302, 0.3424387399, 0.3120802337, 0.7003970577, 0.1556768013, 0.5504151494, 0.6198858838, 0.5639975408, 0.6005967693, 0.3505180292, 0.5527126085, 0.6887327524, 0.5782618174, 0.4792736810, 0.3127952238, 0.1107229101, 0.5514905204, 0.5568147747, 0.7904348876, 0.6297142275, 0.9969978076, 0.8145126198,
    0.0891614271, 0.6738798898, 0.2752702647, 0.0792932730, 0.4821553307, 0.5073550735, 0.5143602903, 0.8580102886, 0.9734973977, 0.6906858759, 0.0112051879, 0.4846233623, 0.5563355412, 0.6336978815, 0.4652177489, 0.5226450927, 0.8500987100, 0.5105837802, 0.9173687916, 0.4965466591, 0.0286197545, 0.6941339771, 0.6797021184, 0.1750842418, 0.2428437526, 0.7846603356, 0.4637142852, 0.5379670489, 0.4498315615, 0.2287200446, 0.6939706446, 0.1120059717, 0.5462369799, 0.4200930552, 0.9867872820, 0.5035517515, 0.0573214859, 0.8893057235, 0.0445228110, 0.4062884036, 0.2241242194, 0.0187810377, 0.5206151197, 0.3234116553, 0.4067530606, 0.4937472941, 0.4403010558, 0.1113067115, 0.0978618591, 0.4028492449, 0.8715409572, 0.7852228964, 0.3657251552, 0.9952221241, 0.0003066581, 0.0229128412, 0.1578300154, 0.6140684158, 0.7546029622, 0.2478871360, 0.2425992536, 0.6243580923, 0.8609598270, 0.7175909203,
] .* 2.0 .- 1.0;

function exec()
    waveform = function (phase::Float32, buffer_pos::Integer)
        parameter_here = parameter[%, 1, buffer_pos]
        if choice == 0
            sin(phase * pi * 2)
        elseif choice == 1
            if phase < parameter_here 
                -1f0 
            else 
                1f0 
            end
        elseif choice == 2
            if phase < parameter_here 
                phase / parameter_here * 2f0 - 1f0
            else
                (1f0 - phase) / (1f0 - parameter_here) * 2f0 - 1f0
            end
        elseif choice == 3
            phase^exp(parameter_here * 8f0 - 4f0) * 2f0 - 1f0
        elseif choice == 4
            hphase = phase * 2.0 % 1.0
            unflipped = if hphase < parameter_here
                hphase / parameter_here
            else
                1.0
            end
            unflipped = unflipped * 2.0 - 1.0
            if phase >= 0.5
                -unflipped
            else
                unflipped
            end
        elseif choice == 5
            cos(Ï€ * (parameter_here * 6 + 1)^2 * phase^2)
        elseif choice == 6
            NOISE_TABLE[Int32(floor(phase * parameter_here * 255.9 + 1))]
        else
            @assert choice == 7
            num_steps = floor(parameter_here * 48 + 2)
            (phase - phase % (1.0 / num_steps)) * 2.0 - 1.0
        end
    end
end